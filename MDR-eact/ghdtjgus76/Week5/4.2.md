## 4.2 서버 사이드 렌더링을 위한 리액트 API 살펴보기

리액트는 리액트 애플리케이션을 서버에서 렌더링할 수 있는 API도 제공함
이는 브라우저의 window 환경이 아닌 Node.js 같은 서버 환경에서만 실행할 수 있고 window 환경에서 실행 시 에러가 발생할 수 있음

### 4.2.1 renderToString

renderToString은 인수로 넘겨받은 리액트 컴포넌트를 렌더링해 HTML 문자열로 반환하는 함수임
서버 사이드 렌더링을 구현하는 데 가장 기초적인 API임
최초 페이지를 HTML로 먼저 렌더링할 떄 사용하는 함수임

```typescript
import ReactDOMServer from "react-dom/server";

function ChildrenComponent({ fruits }: { fruits: Array<string> }) {
  useEffect(() => {
    console.log(fruits);
  }, [fruits]);

  function handleClick() {
    console.log('hello')
  }

  return (
    <ul>
      {fruits.map((fruit) => (
        <li key={fruit} onClick={handleCLick}>
          {fruit}
        </li>
      ))}
    </ul>
  )
}

function SampleComponent() {
  return (
    <>
      <div>hello</div>
      <ChildrenComponent fruits={['apple', 'banana', 'peach']}>
    </>
  )
}

const result = ReactDOMServer.renderToString(
  React.createElement('div', { id: 'root' }, <SampleComponent />)
)
```

아래와 같은 문자열을 반환함

```html
<div id="root" data-reactroot="">
  <div>hello</div>
  <ul>
    <li>apple</li>
    <li>banana</li>
    <li>peach</li>
  </ul>
</div>
```

위 예제에서는 renderToString을 사용해 실제 브라우저가 그려야 할 HTML 결과로 만들어 냄
그런데 위에서 ChildrenComponent에 있는 useEffect와 같은 훅과 handleClick 같은 이벤트 핸들러는 결과물에 포함되지 않음
renderToString은 인수로 주어진 리액트 컴포넌트를 빠르게 브라우저가 렌더링할 수 있는 HTML을 제공하는데 목적이 있음
클라이언트에서 실행되는 자바스크립트 코드를 포함시키거나 렌더링하는 역할은 해주지 않음
만약 필요하다면 이 HTML과는 별도로 제공해 브라우저에 제공돼야 함

renderToString을 사용하면 초기 렌더링에서 뛰어난 성능을 보일 것이고, 검색 엔진이나 SNS 공유를 위한 메타 정보도 미리 준비한 채로 제공할 수 있음
리액트의 서버 사이드 렌더링은 단순히 최초 HTML 페이지를 빠르게 그려주는데에 목적이 있음
하지만 사용자와 인터랙션할 준비가 되기 위해서는 별도의 자바스크립트 코드를 모두 다운로드, 파싱, 실행하는 과정을 거쳐야 함

그리고 div#root에 있는 data-reactroot는 리액트 컴포넌트의 루트 엘리먼트가 무엇인지 식별하는 역할을 함
이는 자바스크립트를 실행하기 위한 hydrate 함수에서 루트를 식별하는 기준점이 됨
리액트로 만들어진 애플리케이션에서는 리액트의 루트 엘리먼트에 data-reactroot 속성이 있음
